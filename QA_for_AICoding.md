# AIコーディング品質保証プラクティス
品質を保証しつつ、開発工数削減をするためのプラクティスです。

## 思想
- 開発者は設計書などドキュメントの確認を行う
- AIが設計書通りに実装したかについて、開発者によるコードの確認は基本的に行わない
- ドキュメントとコードの差分検出についてAIを信頼し、E2Eテストなど最低限の確認に留める

---

## ワークフロー

##### Phase 1：仕様
- 開発者が基本仕様を作成する
  -  めやす ~1k Records

##### Phase 2：設計
- AIが基本設計を作成する
  - めやす ~5k Records
  - **必須**：リスクアセスメント、テスト一覧、機能シーケンス図
  - **基本**：画面設計、技術スタック、インフラ設計、API一覧
- 開発者が基本設計書をレビューして品質を担保する
- AIがコーディングタスク一覧を作成する
- AIがコーディングタスク一覧と基本設計書の整合性を確認する
  - 開発者は基本的には確認しない
  
##### Phase 3：実装
- AIがコーディングする
- CIを実行し品質を検査する（修正後は常に実行）
  - 指摘があればAIが設計書とコードを修正する

##### Phase 4：報告
- AIが開発報告書を作成する
  - 基本設計との差分がある場合に報告する
- 開発者が開発報告書をレビューして品質を担保する
  - コード自体については基本的に確認しない
  - 設計の変更差分について品質を担保する

##### Phase 5：検証
- AIが設計書とコードの整合性を確認する
- 人間がE2Eテストを実施して品質を担保する
  - 可能な限り単体テストでカバーしてE2E項目を減らす

---

## 欠陥検出マトリクス

| 欠陥の種類 | AI側 | 開発者側 |
|---|---|---|
| 仕様の欠陥 | - | 設計レビュー |
| セキュリティ設計の欠陥 | - | 設計レビュー（リスクアセスメント） |
| 機能設計の欠陥 | - | 設計レビュー（シーケンス図） |
| テスト設計の欠陥 | - | 設計レビュー（テスト一覧） |
| 実装の欠陥 | CI | - |
| 実装漏れ | タスク整合性確認 | - |
| 設計と実装の不整合 | コード整合性確認 | - |
| 機能間の結合不具合 | - | E2Eテスト |

---


---

## ドキュメント詳細
| ドキュメント名 | 概要 |
| :--- | :--- |
| リスクアセスメント | 認証・認可の脆弱性、一般的な機能不備、機能の論理的矛盾など、仕様・アーキテクチャレベルの潜在的欠陥と対策を定義。|
| E2Eテスト一覧  | Given-When-Then形式での振る舞い定義と、非機能要件を定義。 |
| 機能シーケンス図 | コンポーネント間の処理フローと状態遷移を、MermaidまたはPlantUMLのコード形式で定義。 |
| データモデル | テーブル構成、カラムのデータ型、制約、リレーションを定義。 |
| 画面設計 | UIコンポーネント構成を定義。 |
| 技術スタック | 使用する言語、フレームワーク、ライブラリのバージョンを定義。 |
| インフラ設計 | プロビジョニングするクラウドリソース、ネットワーク構成を定義。 |
| API一覧 | エンドポイント、リクエスト/レスポンススキーマを定義。 |

##### ドキュメント共通方針
- 自然言語の記述割合を20%以下に抑え、残り80%以上をAIが解析可能な構造化フォーマットで記述する。
- 要件・期待値は必ず定量化する。


## 原則
- AIによる作成と確認を同一セッションで実施するのは禁忌
- AIによる不具合検出は修正後に再度検出し、検出されない状態まで繰り返す
  - NG：検出⇒修正⇒完了
  - OK：検出⇒修正⇒再検出⇒検出0件⇒完了




